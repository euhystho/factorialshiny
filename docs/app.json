[{"name":"app.R","content":"#\n# This is a Shiny web application. You can run the application by clicking\n# the 'Run App' button above.\n#\n\n# Shiny-related UI libraries\nlibrary(shiny)\nlibrary(shinyjs)\nlibrary(shinyWidgets)\nlibrary(bslib)\nlibrary(bsicons)\nlibrary(paletteer)\n\n#Plot related libraries\nlibrary(plotly)\nlibrary(echarts4r)\nlibrary(kableExtra)\nlibrary(tidyverse)\nlibrary(dae)\n\n#Factorial Design related libraries\nlibrary(AlgDesign)\nlibrary(DoE.base)\nlibrary(daewr)\noptions(shiny.reactlog=TRUE) \n\n\n# Define UI for application\nui <- page_sidebar(\n  useShinyjs(),\n  #TODO: Application Bootswatch Theme\n  theme = bs_theme(bootswatch = \"journal\"),\n  # Application title\n  title = \"Effects of Self-Efficacy on Post-Menopausal Women's Health\",\n  window_title = \"2^k Factorial Design of Healthy Habits Circle Simulations\",\n  \n  tags$head(\n    tags$link(rel = \"stylesheet\", type = \"text/css\", href = \"styles.css\")\n  ),\n  # Mobile Friendly:\n  fillable_mobile = TRUE,\n  mobileDetect('isMobile'),\n  \n  # Sidebar with a slider input for number of bins\n  sidebar = sidebar(\n    title = \"Health Dimensions\",\n    width = 300,\n    fillable = TRUE,\n    selectInput(\n      inputId = \"person\",\n      label = \"Select one of the individuals:\",\n      choices = unique(individuals$name),\n      selected = unique(individuals$name)[1]\n    ),\n    checkboxGroupButtons(\n      \"factors\",\n      \"Select the following categories:\",\n      choices = c(\"Nutrition\", \"Sleep\", \"Exercise\", \"Spirituality\", \"Socialization\", \"Wellbeing\"),\n      selected = c(\"Nutrition\",\"Sleep\"),\n      justified = TRUE,\n      size = 'sm',\n    ),\n    accordion_filters <- accordion(\n      id = \"dims\",\n      accordion_panel(\n        \"Participant Biography\",\n        icon = bs_icon(\"file-person-fill\"),\n        uiOutput(\"bio\")\n      ),\n      accordion_panel(\n        \"Physical Health\",\n        icon = bs_icon(\"heart-pulse-fill\"),\n        checkboxGroupButtons(\n          \"phys\",\n          \"Select to display the following subfactors:\",\n          choices = c(\"Nutrition\", \"Sleep\", \"Exercise\"),\n          selected = c(\"Nutrition\",\"Sleep\"),\n          size = 'sm',\n        ),\n        conditionalPanel(\n          condition = \"input.phys.includes('Nutrition')\",\n          card(\n            card_header(\"Nutrition\"),\n            sliderTextInput(\n              \"calorie_slider\",\n              \"Caloric Intake:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"Below Target\", \"At Target\", \"Above Target\")\n            ),\n            sliderTextInput(\n              \"protein_slider\",\n              \"Protein Intake:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"Below Target\", \"At Target\", \"Above Target\")\n            ),\n            sliderTextInput(\n              \"fat_slider\",\n              \"Fat Intake:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"Below Target\", \"At Target\", \"Above Target\")\n            ),\n            sliderTextInput(\n              \"carb_slider\",\n              \"Carbohydrate Intake:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"Below Target\", \"At Target\", \"Above Target\")\n            ),\n            sliderTextInput(\n              \"fasting_slider\",\n              \"Choose the type of fasting:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"Dry\", \"Water\", \"Intermittent\")\n            ),\n            sliderTextInput(\n              \"other_nutr_slider\",\n              \"Choose how much of any other nutritional factor:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"Below Target\", \"At Target\", \"Above Target\")\n            ),\n          )\n        ),\n        conditionalPanel(\n          condition = \"input.phys.includes('Sleep')\",\n          card(\n            card_header(\"Sleep\"),\n            sliderInput(\n              \"sleep_quan_slider\",\n              \"Choose how many hours of Sleep:\",\n              min = 0,\n              max = 10,\n              value = c(6, 9)\n            ),\n            sliderTextInput(\n              \"sleep_qual_slider\",\n              \"Choose the quality of Sleep:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"Poor\", \"Good\", \"Excellent\")\n            ),\n            sliderInput(\n              \"sleep_eat_slider\",\n              \"Choose how many hours since eating before bed:\",\n              min = 0,\n              max = 8,\n              value = 3,\n            ),\n            sliderInput(\n              \"screentime_slider\",\n              \"Choose how much screentime before bed:\",\n              min = 0,\n              max = 5,\n              value = 3,\n            ),\n            sliderInput(\n              \"melatonin_slider\",\n              \"Choose how many mgs of Melatonin are taken before bed:\",\n              min = 0,\n              max = 10,\n              value = 0,\n            ),\n          ),\n        ),\n        conditionalPanel(\n          condition = \"input.phys.includes('Exercise')\",\n          card(\n            card_header(\"Exercise\"),\n            sliderTextInput(\n              \"swim_slider\",\n              \"Choose the intensity of Swimming:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"None\",\"Light\", \"Intense\")\n            ),\n            sliderTextInput(\n              \"run_slider\",\n              \"Choose the intensity of Running:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"None\",\"Light\", \"Intense\")\n            ),\n            sliderTextInput(\n              \"walk_slider\",\n              \"Choose the intensity of Walking:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"None\",\"Light\", \"Intense\")\n            ),\n            sliderTextInput(\n              \"hike_slider\",\n              \"Choose the intensity of Hiking:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"None\",\"Light\", \"Intense\")\n            ),\n            sliderTextInput(\n              \"bike_slider\",\n              \"Choose the intensity of Biking:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"None\",\"Light\", \"Intense\")\n            ),\n            sliderTextInput(\n              \"team_slider\",\n              \"Choose the intensity of Team Sport:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"None\",\"Light\", \"Intense\")\n            ),\n            sliderTextInput(\n              \"lifting_slider\",\n              \"Choose the intensity of Weightlifting:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"None\",\"Light\", \"Intense\")\n            ),\n            sliderTextInput(\n              \"other_exerc_slider\",\n              \"Choose the intensity of Other Exercise:\",\n              grid = TRUE,\n              force_edges = TRUE,\n              choices = c(\"None\",\"Light\", \"Intense\")\n            ),\n          )\n        ),\n      ),\n      accordion_panel(\n        \"Social Health\",\n        icon = bs_icon(\"people-fill\"),\n        card (\n          sliderInput(\n            \"friends_slider\",\n            \"Specify the amount of hours socializing with friends per week:\",\n            min = 0,\n            max = 25,\n            value = 10\n          ),\n          sliderInput(\n            \"strangers_slider\",\n            \"Specify amount of hours socializing with strangers per week:\",\n            min = 0,\n            max = 20,\n            value = 10\n          ),\n          sliderInput(\n            \"vol_slider\",\n            \"Specify the amount of time a week spent doing community service:\",\n            min = 0,\n            max = 30,\n            value = 10\n          )\n        )\n      ),\n      accordion_panel(\n        \"Mental Health\",\n        icon = bs_icon(\"person-circle\"),\n        card(\n          sliderInput(\n            \"read_slider\",\n            \"Choose how many hours spent reading:\",\n            min = 0,\n            max = 15,\n            value = 5\n          ),\n          sliderInput(\n            \"journal_slider\",\n            \"Choose how many hours spent journaling:\",\n            min = 0,\n            max = 5,\n            value = 3\n          ),\n          sliderInput(\n            \"mental_slider\",\n            \"Choose how many hours promoting mental health through an activity (e.g., therapy, support group):\",\n            min = 0,\n            max = 20,\n            value = 2\n          ),\n          sliderInput(\n            \"wellbeing_slider\",\n            \"Choose how many hours engaging in an activity that promotes wellbeing:\",\n            min = 0,\n            max = 20,\n            value = 2\n          )\n        )\n        \n      ),\n      accordion_panel(\n        \"Spiritual Health\",\n        icon = bs_icon(\"yin-yang\"),\n        card(\n          sliderInput(\n            \"meditate_slider\",\n            \"Choose how many hours a week spent meditating:\",\n            min = 0,\n            max = 5,\n            value = 2\n          ),\n          sliderInput(\n            \"mindful_slider\",\n            \"Choose how many hours a week are spent practicing mindfulness:\",\n            min = 0,\n            max = 5,\n            value = 1\n          ),\n          sliderInput(\n            \"religious_slider\",\n            \"Choose how many hours a week spent at a religious institution:\",\n            min = 0,\n            max = 10,\n            value = 3\n          ),\n          sliderInput(\n            \"pray_slider\",\n            \"Choose how many hours a week spent praying:\",\n            min = 0,\n            max = 5,\n            value = 1\n          ),\n          sliderInput(\n            \"yoga_slider\",\n            \"Choose how many hours a week spent doing yoga:\",\n            min = 0,\n            max = 5,\n            value = 3\n          ),\n          sliderInput(\n            \"sacred_slider\",\n            \"Choose how many hours a week are spent studying sacred texts:\",\n            min = 0,\n            max = 10,\n            value = 2\n          ),\n          sliderInput(\n            \"spirit_slider\",\n            \"Choose how many hours a week are spent on other spiritual activities:\",\n            min = 0,\n            max = 10,\n            value = 2\n          )\n        )\n        \n      ),\n    ),\n  ),\n  tabsetPanel(\n    id = \"tabs\",\n    nav_panel(title = \"Introduction\", value = \"intro\", intro_card),\n    nav_panel(title = \"Design Cube(s)\", value = \"cube\", plot_card[[2]]),\n    nav_panel(title = \"Assumptions\", value = \"assumption\",\n              navset_card_underline(\n                nav_panel(title = \"Independence\", text_card[[1]]),\n                nav_panel(title = \"Residual vs Fitted\", plot_card[[4]]),\n                nav_panel(title = \"Normal QQ Plot\", plot_card[[5]]),\n                nav_panel(title = \"Outliers\", text_card[[2]])\n              )\n    ),\n    nav_panel(title = \"Interaction Plot\", value = \"interaction\", plot_card[[1]]),\n    nav_panel(title = \"Effects\", value = \"effect\", plot_card[[3]]),\n    footer = tagList(\n      conditionalPanel(\n        condition = \"input.tabs != 'intro' && input.tabs != 'effect'\",\n        layout_columns(table_card[[2]], table_card[[1]], col_widths = c(4, 8))\n      ),\n      conditionalPanel(\n        condition = \"input.tabs == 'effect'\",\n        table_card[[3]]\n      )\n    )\n  ),\n  \n)\n\n# Define server logic\nserver <- function(input, output, session) {\n  \n  f <- reactiveValues(\n    data = NULL,\n    design = NULL,\n    result = NULL,\n    std_dev = NULL,\n    health_value = NULL\n  )\n  \n  factorCalc <- reactive({\n    numSelectedFactors <- length(input$factors)\n    if (numSelectedFactors < 2 || numSelectedFactors > 6) {\n      showNotification(\"Please select 2 to 6 factors to display the interaction plot\")\n      stop(\"Please select 2 to 6 factors\")\n    }\n    \n    factorLabels <- labelFactors(input$factors, factor_labels)\n    levels <- rep(2, numSelectedFactors)\n    design <- gen.factorial(levels, nVars = numSelectedFactors, varNames = input$factors)\n    \n    factorLevels <- lapply(seq_len(numSelectedFactors), function(i) {\n      list(low = factorLabels[[i]][[1]], high = factorLabels[[i]][[2]])\n    })\n    \n    names(factorLevels) <- input$factors\n    \n    ind_combinations <- expand.grid(factorLevels)\n    \n    # Create effect indicators for each combination (0 for low, 1 for high)\n    effect_df <- data.frame(row.names = 1:nrow(ind_combinations))\n    for (i in 1:numSelectedFactors) {\n      factor <- input$factors[i]\n      high_label <- factorLabels[[i]][[2]]\n      effect_df[[factor]] <- ifelse(ind_combinations[[factor]] == high_label, 1, 0)\n    }\n    effect_matrix <- as.matrix(effect_df)\n    \n    combinations <- expand.grid(lapply(factorLevels, function(lvl) c(lvl$low, lvl$high)))\n    expandedCombinations <- do.call(rbind, replicate(15, combinations, simplify = FALSE))\n    factorNames <- paste0(\"factor\", LETTERS[1:numSelectedFactors])\n    colnames(expandedCombinations) <- factorNames\n    \n    row <- which(weights$name == input$person)\n    ind_weights <- as.numeric(weights[row, input$factors])\n    \n    # Calculate mean health scores for the individual\n    sigma <- 1  # Adjust as needed\n    mean_health <- effect_matrix %*% ind_weights\n    \n    mean_health_expanded <- rep(mean_health, each = 15)\n    health <- mean_health_expanded + rnorm(length(mean_health_expanded), 0, sigma)\n    \n    data <- cbind(expandedCombinations, health = health)\n    \n    anovaVars <- LETTERS[1:numSelectedFactors]\n    anovaFormula <- as.formula(\n      paste(\"health ~\", paste(anovaVars, collapse = \" * \"))\n    )\n    \n    for (i in 1:numSelectedFactors) {\n      assign(anovaVars[i], data[[factorNames[i]]])\n    }\n    H <- data$health\n    \n    f$result <- aov(anovaFormula, data = data)\n    f$design <- design\n    f$data <- data\n    \n  })\n  \n  getModel <- reactive({\n    numSelectedFactors = length(input$factors)\n    factorCalc()\n    df <- f$data\n    \n    A <- df$factorA\n    B <- df$factorB\n    C <- df$factorC\n    D <- df$factorD\n    E <- df$factorE\n    F <- df$factorF\n    H <- df$health\n    \n    factors <- c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\")  # List all possible factors\n    selected_factors <- factors[1:numSelectedFactors]\n    if (numSelectedFactors >= 2){\n      formula_str <- paste(\"H ~\", paste(selected_factors, collapse=\"*\"))\n      contrasts_list <- setNames(\n        replicate(numSelectedFactors, contr.FrF2, simplify = FALSE),\n        selected_factors\n      )\n      model <- lm(as.formula(formula_str), data = df, contrasts = contrasts_list)\n    }\n    return(model)\n  })\n  \n  # Function to generate summary without creating plots\n  generate_summary <- reactive({\n    # Ensure at least 2 health dimensions are selected\n    if (length(input$factors) < 2) {\n      f$std_dev <- NULL\n      f$health_value <- NULL\n      return(NULL)\n    }\n    \n    factorCalc()\n    data <- f$data\n    factors_lookup <- lookupFactors()\n    \n    # Initialize default values\n    f$std_dev <- NA\n    f$health_value <- NA\n    \n    # Extract the factors (only handle 2 factors for now)\n    if (length(input$factors) == 2) {\n      # Get the two selected factors\n      selected_factors <- input$factors\n      factor1 <- selected_factors[1]\n      factor2 <- selected_factors[2]\n      \n      # Get factor labels from factor_labels\n      low1 <- factor_labels[[factor1]][[1]]  # Low level for first factor\n      high1 <- factor_labels[[factor1]][[2]] # High level for first factor\n      low2 <- factor_labels[[factor2]][[1]]  # Low level for second factor\n      high2 <- factor_labels[[factor2]][[2]] # High level for second factor\n      \n      \n      A <- data$factorA\n      B <- data$factorB\n      H <- data$health\n      \n      # Map the factor levels to numeric or categorical for tapply\n      # Assume factorA and factorB in data are already labeled as \"Low\"/\"High\" or similar\n      levels_A <- unique(A)\n      levels_B <- unique(B)\n      \n      # Ensure levels match factor_labels\n      if (!all(levels_A %in% c(low1, high1)) || !all(levels_B %in% c(low2, high2))) {\n        warning(\"Factor levels in data do not match expected labels. Attempting to map.\")\n        # Map data levels to low/high\n        A_mapped <- ifelse(A %in% c(low1), \"Low\", \"High\")\n        B_mapped <- ifelse(B %in% c(low2), \"Low\", \"High\")\n      } else {\n        A_mapped <- A\n        B_mapped <- B\n      }\n      \n      # Calculate means and standard deviations\n      means <- tapply(H, list(A_mapped, B_mapped), mean, na.rm = TRUE)\n      sd <- tapply(H, list(A_mapped, B_mapped), sd, na.rm = TRUE)\n      \n      \n      # Define low_low and high_high based on factor_labels (no need for complex lookup)\n      low_low <- c(low1, low2)  # Worst case: both factors at low level\n      high_high <- c(high1, high2)  # Best case: both factors at high level\n      \n      # Extract indices for low_low and high_high\n      low_low_idx <- c(match(low_low[1], dimnames(means)[[1]]), match(low_low[2], dimnames(means)[[2]]))\n      high_high_idx <- c(match(high_high[1], dimnames(means)[[1]]), match(high_high[2], dimnames(means)[[2]]))\n      \n      \n      # Extract values\n      mod_insuf <- means[low_low_idx[1], low_low_idx[2]]  # Worst case\n      int_suf <- means[high_high_idx[1], high_high_idx[2]]  # Best case\n      \n      mod_insuf_sd <- sd[low_low_idx[1], low_low_idx[2]]  # SD for worst case\n\n      \n      # Calculate differences and approximate percentage improvement\n      diff_health <- int_suf - mod_insuf\n      pct_improve <- if (mod_insuf != 0) (diff_health / mod_insuf) * 100 else 0  # Avoid division by zero\n      \n      # Standard deviation-based health improvement\n      diff_health_sd <- if (mod_insuf_sd != 0) (int_suf - mod_insuf) / mod_insuf_sd else 0  # Avoid division by zero\n      \n      # Store results\n      f$std_dev <- round(diff_health_sd, 2)\n      f$health_value <- round(pct_improve, 1)\n    }\n    \n    return(TRUE)  # Indicate success\n  })\n  \n  selected_data <- reactive({\n    req(input$person) \n    row <- which(individuals$name == input$person)\n    if (length(row) == 0) return(NULL)\n    individuals[row, ]  \n  })\n  \n  observe({\n    data <- selected_data()\n    if (is.null(data)) return()\n    \n    for (col in names(data)){\n      if (col == \"person\") next\n      \n      value <- data[[col]]\n      \n      if(is.numeric(value) || is.list(value)){\n        if (is.list(value)) {\n          value <- unlist(value)  # Ensure it's a numeric vector\n        }\n        updateSliderInput(session, col, value = value)\n      } else if (is.character(value)) {\n        updateSliderTextInput(session, col, selected = value)\n      } \n    }\n  })\n  \n  # Update the output renderers to handle the case when fewer than 2 dimensions are selected\n  output$sd <- renderText({\n    isTwoFactor = length(input$factors) == 2\n    if (!isTwoFactor || is.null(generate_summary())) {\n      return(\"N/A\")\n    }\n    return(f$std_dev)\n  })\n  \n  output$health_change <- renderText({\n    isTwoFactor = length(input$factors) == 2\n    if (!isTwoFactor || is.null(generate_summary())) {\n      return(\"N/A\")\n    }\n    return(paste0(f$health_value, \"%\"))\n  })\n  \n  output$interaction_plot <- renderEcharts4r({\n    numFactors <- length(input$factors)\n    \n    factorCalc()\n    df <- f$data\n    \n    # Use the selected dimensions for plot labels\n    labels <- labelFactors(input$factors, factors_plot_labels)\n    \n    # Create a placeholder empty chart\n    empty_chart <- data.frame(x = 1, y = 1) %>%\n      e_charts(x) %>%\n      e_scatter(y, symbol_size = 0) %>%  # Invisible point\n      e_title(text = \"Interaction Plot\", \n              subtext = \"Please select exactly two factors to display an interaction plot\") %>%\n      e_x_axis(show = FALSE) %>%\n      e_y_axis(show = FALSE) %>%\n      e_grid(left = \"15%\", right = \"15%\", top = \"20%\", bottom = \"15%\")\n    \n    if (numFactors == 2) {\n      # Summarize the data to get means for each combination\n      sum_df <- df %>%\n        group_by(factorA, factorB) %>%\n        summarise(Mean_Health = mean(health), .groups = 'keep') %>%\n        ungroup()\n      \n      plot <- sum_df %>%\n        group_by(factorB) %>%\n        e_charts(x = factorA) %>%  \n        e_line(serie = Mean_Health, legend = TRUE) %>%  \n        e_aria(enabled = TRUE, decal = list(show = TRUE)) %>%\n        e_tooltip(trigger = \"axis\") %>%\n        e_title(text = \"Interaction Plot\") %>%\n        e_x_axis(name = labels[1]) %>%\n        e_y_axis(name = \"Health\") %>%\n        e_toolbox_feature(\"dataZoom\") %>%\n        e_toolbox_feature(feature = \"reset\") %>%\n        e_legend(formatter = paste0(\"{name} \", labels[2]))\n      \n      return(plot)\n    } else {\n      empty_chart <- empty_chart %>%\n              e_legend(show = FALSE)\n      # Instead of just showing a notification, return a placeholder chart with a message\n      showNotification(\"Please select two factors to display values in the interaction plot!\")\n      return(empty_chart)\n    }\n  })\n  \n  output$factorial <- renderPlotly({\n    # Create factorial design grid\n    df <- expand.grid(\n      factorA = c(-1, 1),\n      factorB = c(-1, 1),\n      factorC = c(-1, 1)\n    )\n    \n    # Add hover text using dynamic factor_names\n    df$factorA_text <- ifelse(df$factorA == -1, \n                              factor_labels[[factor_names[1]]][[1]], \n                              factor_labels[[factor_names[1]]][[2]])\n    df$factorB_text <- ifelse(df$factorB == -1, \n                              factor_labels[[factor_names[2]]][[1]], \n                              factor_labels[[factor_names[2]]][[2]])\n    df$factorC_text <- ifelse(df$factorC == -1, \n                              factor_labels[[factor_names[3]]][[1]], \n                              factor_labels[[factor_names[3]]][[2]])\n    \n    # Edge definitions \n    edges <- list(\n      c(1, 2), c(2, 4), c(4, 3), c(3, 1),  # Bottom square\n      c(5, 6), c(6, 8), c(8, 7), c(7, 5),  # Top square\n      c(1, 5), c(2, 6), c(3, 7), c(4, 8)   # Vertical edges\n    )\n    \n    # Set up the color palette\n    edge_colors <- paletteer_d(\"DresdenColor::paired\")\n    \n    # Function to determine changing factor and generate edge label dynamically\n    get_edge_info <- function(df, edge, factor_names) {\n      v1 <- df[edge[1], ]\n      v2 <- df[edge[2], ]\n      \n      # Identify which factor changes (columns 1:3 are factorA, factorB, factorC)\n      diff_factor <- which(v1[1:3] != v2[1:3])\n      if (length(diff_factor) != 1) stop\n      (\"Error: Exactly one factor should change per edge\")\n      \n      # Get the factor name and levels dynamically\n      factor_name <- factor_names[diff_factor]\n      level1 <- v1[[paste0(\"factor\", LETTERS[diff_factor], \"_text\")]]\n      level2 <- v2[[paste0(\"factor\", LETTERS[diff_factor], \"_text\")]]\n      \n      # Create label with proper capitalization\n      label <- paste0(\n        toupper(substr(factor_name, 1, 1)),\n        substr(factor_name, 2, nchar(factor_name)),\n        \": \", level1, \" ‚Üí \", level2\n      )\n      \n      return(label)\n    }\n    \n    # Initialize plot \n    plot <- plot_ly()\n    \n    # Add edges with dynamic labels\n    for (i in seq_along(edges)) {\n      edge <- edges[[i]]\n      edge_label <- get_edge_info(df, edge, factor_names)\n      \n      plot <- plot %>% add_trace(\n        x = df$factorA[edge],\n        y = df$factorB[edge],\n        z = df$factorC[edge],\n        type = 'scatter3d',\n        mode = 'lines',\n        name = edge_label,\n        line = list(color = edge_colors[i], width = 6),\n        hoverinfo = 'skip',\n        showlegend = TRUE\n      )\n    }\n    \n    # Add vertices\n    hover_template <- paste(factor_names[1], \": %{customdata[0]}<br>\",\n                            factor_names[2], \": %{customdata[1]}<br>\",\n                            factor_names[3], \": %{customdata[2]}\",\n                            \"<extra><\/extra>\")\n    \n    custom_data <- lapply(1:nrow(df), function(i) {\n      list(df$factorA_text[i], df$factorB_text[i], df$factorC_text[i])\n    })\n    \n    plot <- plot %>% add_trace(\n      x = df$factorA,\n      y = df$factorB,\n      z = df$factorC,\n      type = 'scatter3d',\n      mode = 'markers',\n      name = \"Factor Points\",\n      marker = list(size = 8, color = \"black\", symbol = \"circle\"),\n      customdata = custom_data,\n      hovertemplate = hover_template\n    )\n    \n    # Layout configuration \n    plot %>% layout(\n      scene = list(\n        xaxis = list(title = factor_names[1], showgrid = FALSE),\n        yaxis = list(title = factor_names[2], showgrid = FALSE),\n        zaxis = list(title = factor_names[3], showgrid = FALSE)\n      ),\n      title = \"3-D Representation of the 2·µè Factorial Design\",\n      legend = list(\n        title = list(text = \"Factors and Levels\"),\n        orientation = \"h\",\n        visible = ifelse(input$isMobile, FALSE, TRUE)\n      )\n    )\n  })\n  \n  output$effects_plot <- renderPlot({\n    model <- getModel()\n    \n    # Extract coefficients (half effects)\n    coeffs <- coef(model)[-1]  # Remove intercept\n    \n    # Create half-normal plot of effects\n    par(mfrow = c(1, 2))\n    \n    # Normal plot\n    qqnorm(coeffs, main = \"Normal Plot of Effects\", \n           xlab = \"Normal Scores\", ylab = \"Estimated Effects\", \n           pch = 16, col = \"blue\")\n    abline(lm(sort(coeffs) ~ qnorm(ppoints(length(coeffs)))))\n    \n    # Half-normal plot\n    abs_coeffs <- abs(coeffs)\n    qqnorm(abs_coeffs, main = \"Half-Normal Plot of Effects\", \n           xlab = \"Half-Normal Scores\", ylab = \"Absolute Effects\", \n           pch = 16, col = \"red\", plot.it = FALSE)\n    plot_data <- qqnorm(abs_coeffs, plot.it = FALSE)\n    plot(plot_data$x, plot_data$y, main = \"Half-Normal Plot of Effects\", \n         xlab = \"Half-Normal Scores\", ylab = \"Absolute Effects\", \n         pch = 16, col = \"red\")\n    \n    # Add labels for significant effects\n    parnames <- names(coeffs)\n    labeled <- abs_coeffs > (2 * sd(abs_coeffs))\n    if (any(labeled)) {\n      factor_labels <- formatSigEffect(parnames[labeled], input$factors)\n      text(plot_data$x[labeled], plot_data$y[labeled], \n           labels = factor_labels, pos = 2)\n    }\n  })\n  \n  output$independence <- renderPrint({\n    cat(\"When looking at our factors they are orthogonal since they do not depend on one another. \\nThus, this design fufills the condition of independence.\")\n  })\n  \n  output$residual <- renderPlot({\n    numFactors <- length(input$factors)\n    if (numFactors < 2) {\n      return()\n    }\n    model <- getModel()\n    plot(fitted(model), residuals(model), \n         xlab = \"Fitted Values\", ylab = \"Residuals\",\n         main = \"Residuals vs Fitted\", pch = 19, col = \"blue\")\n    abline(h = 0, lty = 2, col = \"red\")\n  })\n  \n  output$QQ <- renderPlot({\n    numFactors <- length(input$factors)\n    if (numFactors < 2) {\n      return()\n    }\n    model <- getModel()\n    qqnorm(residuals(model), main = \"Normal Q-Q Plot\", pch = 19, col = \"blue\")\n    qqline(residuals(model), col = \"red\", lwd = 2)\n  })\n  \n  output$outlier <- renderPrint({\n    numFactors <- length(input$factors)\n    if (numFactors < 2) {\n      return()\n    }\n    model <- getModel()\n    df <- f$data\n    tryCatch({\n      cat(\"Gaptest Analysis for Outlier Detection:\\n\")\n      gap_result <- Gaptest(df)\n      \n      if (is.null(gap_result)){\n        cat(\"There are no outliers in this dataset!\")\n      } else {\n        print(gap_result)\n      }\n    }, error = function(e) {\n      cat(\"Error in outlier detection: \", e$message, \"\\n\")\n      cat(\"Cook's Distances for potential outliers:\\n\")\n      cooks_d <- cooks.distance(model)\n      print(sort(cooks_d[cooks_d > 4/length(cooks_d)], decreasing = TRUE))\n    })\n  })\n  \n  output$effects_output <- renderUI({\n    model <- getModel()\n    \n    # Extract coefficients (half effects)\n    coeffs <- coef(model)[-1]  # Remove intercept\n    \n    # Calculate full effects (2 √ó coefficients)\n    effects <- 2 * coeffs\n    \n    # Create a data frame of effects\n    effects_df <- data.frame(\n      Estimate = effects,\n      `Half_Effect` = coeffs,\n      `Std_Error` = summary(model)$coefficients[-1, \"Std. Error\"],\n      `t_value` = summary(model)$coefficients[-1, \"t value\"],\n      `Pr(>|t|)` = summary(model)$coefficients[-1, \"Pr(>|t|)\"]\n    )\n    sig_effects <- which(effects_df[[5]] < 0.05)\n    \n    effects_df <- labelTableFactors(effects_df,input$factors)\n    \n    \n    HTML(\n      kable(effects_df, row.names = TRUE) %>%\n        kable_styling(\n          bootstrap_options = c(\"striped\", \"responsive\"),\n          full_width = FALSE,\n          position = \"left\"\n        ) %>%\n        # Highlight significant p-values\n        row_spec(\n          sig_effects,\n          bold = TRUE,\n          background = \"#e67763\",\n          color = \"#FFF\"\n        ) %>%\n        # Add footer with significance key\n        add_footnote(\n          c(\"Significant Effects are highlighted if p < 0.05\"),\n          notation = \"none\"\n        )\n    )\n    \n  })\n  \n  output$anova <- renderUI({\n    if (length(input$factors) < 2){\n      return()\n    }\n    factorCalc()\n    table <- displayTable(f,input$factors, \"anova\")\n  })\n  \n  output$design <- renderUI({\n    if (length(input$factors) < 2){\n      return()\n    }\n    factorCalc()\n    table <- displayTable(f, input$factors, \"design\")\n  })\n  \n  output$bio <- renderUI({\n    bio <- as.character(individuals[trimws(individuals$name) == input$person,\n                                    \"biography\"][1])\n  })\n  \n\n  \n}\n\n# Run the application\nshinyApp(ui, server)\n","type":"text"},{"name":"Data/ind_data.rds","content":"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\nAV67qp7CIQAA","type":"binary"},{"name":"Data/ind_weights.rds","content":"H4sIAAAAAAAAA2VTMU8CMRitcASOiDFBZXXEQRYXt4uDDgouaHRwqVi0yXGHdxDFiT+gF0kc\nZGHV+AdMQAdd9U8wmJiYeCAYXIy9o1+V+iVNr+997/V9oWxHEUJBpCgBFAyxTxTa3FiZX2RY\nnB3CbE2yFUGoqrJ9OostfDDrNs6v3YbTbFdP3UatxclExjToYZkAfe/Tzg1oV4lhVIBs+eTZ\nFSdn0qZFgbtjXLt+8X7rgHSN6LokFdfGlwqV0UTiykSG6NS28WiiWpPTU2n6y7WEFE14E2sf\nC35pbrL/4OzMaQPkl+ZK+2feL3HuPXn1LHw6TJ3sP2o9zr9eelXXXiQd4JKf8OlyHHKBX1fy\ngZxf3G8g+XQ4Ls/Bc/+bszfqJ3wAh/43rof84Ad9gPNd+Ayke2QdzAs7+Ii52NNFaAwpyPtN\nQwYuEBsNn22Yg4oH8m91vVyyaImaBiiyOiFFfogsHxMrR23oHs8WKesuY52WKhyLZc0cZcAJ\n/uOibrEnukuosS8HyunYhkAARvdwCafylhdrtF21zKMUzBBjK1AdTsn+guj7B7KL6kmuAwAA\n","type":"binary"},{"name":"Data/individual_data.json","content":"[\n  {\n    \"name\": \"Sarah üë©üèª‚Äçüíº\",\n    \"biography\": \"Sarah is a dedicated accountant who takes pride in maintaining a balanced diet. She carefully tracks her nutrition and has been consistently meeting her calorie targets while working on increasing her protein intake. Recently, she's started incorporating more regular walks into her routine and is planning to expand her exercise regimen. She practices intermittent fasting and volunteers regularly in her community. Sarah is beginning to explore mindfulness practices to help manage work-related stress.\",\n    \"calorie_slider\": \"At Target\",\n    \"protein_slider\": \"Below Target\",\n    \"fat_slider\": \"At Target\",\n    \"carb_slider\": \"At Target\",\n    \"fasting_slider\": \"Intermittent\",\n    \"other_nutr_slider\": \"At Target\",\n    \"sleep_quan_slider\": \"7,8\",\n    \"sleep_qual_slider\": \"Excellent\",\n    \"sleep_eat_slider\": 3,\n    \"screentime_slider\": 1,\n    \"melatonin_slider\": 0,\n    \"swim_slider\": \"None\",\n    \"run_slider\": \"None\",\n    \"walk_slider\": \"Light\",\n    \"hike_slider\": \"None\",\n    \"bike_slider\": \"None\",\n    \"team_slider\": \"None\",\n    \"lifting_slider\": \"None\",\n    \"other_exerc_slider\": \"None\",\n    \"friends_slider\": 0,\n    \"strangers_slider\": 0,\n    \"vol_slider\": 10,\n    \"read_slider\": 0,\n    \"journal_slider\": 0,\n    \"mental_slider\": 4,\n    \"wellbeing_slider\": 0,\n    \"meditate_slider\": 0,\n    \"mindful_slider\": 0,\n    \"religious_slider\": 1,\n    \"pray_slider\": 1,\n    \"yoga_slider\": 0,\n    \"sacred_slider\": 0,\n    \"spirit_slider\": 0\n  },\n  {\n    \"name\": \"Monique üë©üèæ‚Äçüè´\",\n    \"biography\": \"Monique is a high school science teacher with a passion for outdoor activities. She regularly hikes on weekends and participates in community clean-up events. Monique prioritizes getting enough sleep and follows a balanced diet, though she occasionally indulges in her favorite desserts. She enjoys spending time with friends and has recently started a book club to combine her love of reading with social interaction.\",\n    \"calorie_slider\": \"At Target\",\n    \"protein_slider\": \"At Target\",\n    \"fat_slider\": \"At Target\",\n    \"carb_slider\": \"At Target\",\n    \"fasting_slider\": \"Water\",\n    \"other_nutr_slider\": \"At Target\",\n    \"sleep_quan_slider\": \"7,8\",\n    \"sleep_qual_slider\": \"Good\",\n    \"sleep_eat_slider\": 3,\n    \"screentime_slider\": 2,\n    \"melatonin_slider\": 0,\n    \"swim_slider\": \"None\",\n    \"run_slider\": \"None\",\n    \"walk_slider\": \"Light\",\n    \"hike_slider\": \"Light\",\n    \"bike_slider\": \"None\",\n    \"team_slider\": \"None\",\n    \"lifting_slider\": \"None\",\n    \"other_exerc_slider\": \"None\",\n    \"friends_slider\": 15,\n    \"strangers_slider\": 5,\n    \"vol_slider\": 10,\n    \"read_slider\": 10,\n    \"journal_slider\": 0,\n    \"mental_slider\": 5,\n    \"wellbeing_slider\": 5,\n    \"meditate_slider\": 0,\n    \"mindful_slider\": 0,\n    \"religious_slider\": 2,\n    \"pray_slider\": 0,\n    \"yoga_slider\": 0,\n    \"sacred_slider\": 0,\n    \"spirit_slider\": 2\n  },\n  {\n    \"name\": \"Jenny üë©üèº‚Äçüé®\",\n    \"biography\": \"Jenny is a freelance graphic designer who works from home. She's health-conscious and follows a high-protein diet to support her weightlifting routine. Jenny is disciplined about her sleep schedule and avoids screen time before bed. She struggles with social interactions due to her remote work situation but has recently joined a local gym to meet new people. Jenny keeps a daily journal to track her fitness progress and emotional wellbeing.\",\n    \"calorie_slider\": \"At Target\",\n    \"protein_slider\": \"Above Target\",\n    \"fat_slider\": \"Below Target\",\n    \"carb_slider\": \"At Target\",\n    \"fasting_slider\": \"Intermittent\",\n    \"other_nutr_slider\": \"At Target\",\n    \"sleep_quan_slider\": \"7,8\",\n    \"sleep_qual_slider\": \"Excellent\",\n    \"sleep_eat_slider\": 2,\n    \"screentime_slider\": 1,\n    \"melatonin_slider\": 0,\n    \"swim_slider\": \"None\",\n    \"run_slider\": \"None\",\n    \"walk_slider\": \"Light\",\n    \"hike_slider\": \"None\",\n    \"bike_slider\": \"None\",\n    \"team_slider\": \"None\",\n    \"lifting_slider\": \"Intense\",\n    \"other_exerc_slider\": \"None\",\n    \"friends_slider\": 5,\n    \"strangers_slider\": 5,\n    \"vol_slider\": 0,\n    \"read_slider\": 5,\n    \"journal_slider\": 5,\n    \"mental_slider\": 10,\n    \"wellbeing_slider\": 10,\n    \"meditate_slider\": 3,\n    \"mindful_slider\": 3,\n    \"religious_slider\": 0,\n    \"pray_slider\": 0,\n    \"yoga_slider\": 3,\n    \"sacred_slider\": 0,\n    \"spirit_slider\": 2\n  },\n  {\n    \"name\": \"Lori üë©üèΩ‚Äç‚öïÔ∏è\",\n    \"biography\": \"Lori is a registered nurse working night shifts at a busy hospital. Despite her challenging schedule, she tries to maintain a healthy lifestyle. She struggles with sleep quality and relies on quick meals between shifts. Lori enjoys swimming as her primary form of exercise and uses meditation to manage stress. She has a close circle of friends from nursing school and participates in hospital wellness programs when her schedule allows.\",\n    \"calorie_slider\": \"Below Target\",\n    \"protein_slider\": \"Below Target\",\n    \"fat_slider\": \"At Target\",\n    \"carb_slider\": \"At Target\",\n    \"fasting_slider\": \"Water\",\n    \"other_nutr_slider\": \"At Target\",\n    \"sleep_quan_slider\": \"5,6\",\n    \"sleep_qual_slider\": \"Poor\",\n    \"sleep_eat_slider\": 1,\n    \"screentime_slider\": 2,\n    \"melatonin_slider\": 5,\n    \"swim_slider\": \"Light\",\n    \"run_slider\": \"None\",\n    \"walk_slider\": \"Light\",\n    \"hike_slider\": \"None\",\n    \"bike_slider\": \"None\",\n    \"team_slider\": \"None\",\n    \"lifting_slider\": \"None\",\n    \"other_exerc_slider\": \"None\",\n    \"friends_slider\": 10,\n    \"strangers_slider\": 15,\n    \"vol_slider\": 5,\n    \"read_slider\": 5,\n    \"journal_slider\": 0,\n    \"mental_slider\": 5,\n    \"wellbeing_slider\": 5,\n    \"meditate_slider\": 5,\n    \"mindful_slider\": 3,\n    \"religious_slider\": 0,\n    \"pray_slider\": 0,\n    \"yoga_slider\": 0,\n    \"sacred_slider\": 0,\n    \"spirit_slider\": 0\n  },\n\n  {\n      \"name\": \"Kelly üë©üèº‚Äçüíº\",\n      \"biography\": \"Kelly is a marketing executive and mother of one young child. She balances a demanding career with family responsibilities, often sacrificing personal time. Kelly struggles to maintain consistent exercise but tries to incorporate family walks and bike rides when possible. She's interested in nutrition and meal planning to improve her family's diet. Kelly values her religious community and attends services regularly, finding spiritual connection helps manage her stress.\",\n      \"calorie_slider\": \"At Target\",\n      \"protein_slider\": \"Below Target\",\n      \"fat_slider\": \"Below Target\",\n      \"carb_slider\": \"At Target\",\n      \"fasting_slider\": \"None\",\n      \"other_nutr_slider\": \"At Target\",\n      \"sleep_quan_slider\": \"5,6\",\n      \"sleep_qual_slider\": \"Poor\",\n      \"sleep_eat_slider\": 2,\n      \"screentime_slider\": 4,\n      \"melatonin_slider\": 0,\n      \"swim_slider\": \"None\",\n      \"run_slider\": \"None\",\n      \"walk_slider\": \"Light\",\n      \"hike_slider\": \"None\",\n      \"bike_slider\": \"Light\",\n      \"team_slider\": \"None\",\n      \"lifting_slider\": \"None\",\n      \"other_exerc_slider\": \"None\",\n      \"friends_slider\": 15,\n      \"strangers_slider\": 10,\n      \"vol_slider\": 5,\n      \"read_slider\": 3,\n      \"journal_slider\": 0,\n      \"mental_slider\": 5,\n      \"wellbeing_slider\": 5,\n      \"meditate_slider\": 0,\n      \"mindful_slider\": 0,\n      \"religious_slider\": 8,\n      \"pray_slider\": 8,\n      \"yoga_slider\": 0,\n      \"sacred_slider\": 5,\n      \"spirit_slider\": 5\n  },\n  {\n      \"name\": \"Amy üë©üèª‚Äçüè´\",\n      \"biography\": \"Amy is a college professor teaching environmental science. She's passionate about sustainability and participates in environmental initiatives. Amy maintains an active lifestyle, cycling to classes and swimming. She follows a plant-based diet and enjoys cooking vegetarian meals for her family. Amy struggles with screen time management and sometimes sacrifices sleep to complete lesson plans, but she's working on improving her sleep hygiene and work-life balance.\",\n      \"calorie_slider\": \"At Target\",\n      \"protein_slider\": \"Below Target\",\n      \"fat_slider\": \"Above Target\",\n      \"carb_slider\": \"Above Target\",\n      \"fasting_slider\": \"Water\",\n      \"other_nutr_slider\": \"At Target\",\n      \"sleep_quan_slider\": \"6,7\",\n      \"sleep_qual_slider\": \"Good\",\n      \"sleep_eat_slider\": 2,\n      \"screentime_slider\": 5,\n      \"melatonin_slider\": 0,\n      \"swim_slider\": \"Light\",\n      \"run_slider\": \"Light\",\n      \"walk_slider\": \"Light\",\n      \"hike_slider\": \"None\",\n      \"bike_slider\": \"Intense\",\n      \"team_slider\": \"None\",\n      \"lifting_slider\": \"None\",\n      \"other_exerc_slider\": \"None\",\n      \"friends_slider\": 20,\n      \"strangers_slider\": 15,\n      \"vol_slider\": 20,\n      \"read_slider\": 15,\n      \"journal_slider\": 3,\n      \"mental_slider\": 5,\n      \"wellbeing_slider\": 5,\n      \"meditate_slider\": 0,\n      \"mindful_slider\": 3,\n      \"religious_slider\": 0,\n      \"pray_slider\": 0,\n      \"yoga_slider\": 5,\n      \"sacred_slider\": 0,\n      \"spirit_slider\": 3\n  },\n\n  {\n    \"name\": \"Melissa üë©üèæ‚Äçüíª\",\n    \"biography\": \"Melissa is a senior software developer who recently committed to improving her overall health. After years of sedentary work habits, she's joined a running club and is training for her first 5K. Melissa tracks her nutrition carefully and has been focusing on increasing her protein intake to support her new exercise routine. She practices intermittent fasting and has established a consistent sleep schedule. Melissa enjoys reading personal development books and has started journaling about her fitness journey.\",\n    \"calorie_slider\": \"At Target\",\n    \"protein_slider\": \"Above Target\",\n    \"fat_slider\": \"At Target\",\n    \"carb_slider\": \"At Target\",\n    \"fasting_slider\": \"Intermittent\",\n    \"other_nutr_slider\": \"At Target\",\n    \"sleep_quan_slider\": \"7,8\",\n    \"sleep_qual_slider\": \"Good\",\n    \"sleep_eat_slider\": 0,\n    \"screentime_slider\": 2,\n    \"melatonin_slider\": 0,\n    \"swim_slider\": \"None\",\n    \"run_slider\": \"Light\",\n    \"walk_slider\": \"Intense\",\n    \"hike_slider\": \"None\",\n    \"bike_slider\": \"None\",\n    \"team_slider\": \"None\",\n    \"lifting_slider\": \"Light\",\n    \"other_exerc_slider\": \"None\",\n    \"friends_slider\": 10,\n    \"strangers_slider\": 10,\n    \"vol_slider\": 5,\n    \"read_slider\": 15,\n    \"journal_slider\": 5,\n    \"mental_slider\": 10,\n    \"wellbeing_slider\": 10,\n    \"meditate_slider\": 3,\n    \"mindful_slider\": 3,\n    \"religious_slider\": 0,\n    \"pray_slider\": 0,\n    \"yoga_slider\": 3,\n    \"sacred_slider\": 0,\n    \"spirit_slider\": 0\n  },\n  {\n    \"name\": \"Lisa üë©üèº‚Äçüè´\",\n    \"biography\": \"Lisa is a retired elementary school teacher who now volunteers at her local library. She maintains an active lifestyle through daily walks, gardening, and weekly yoga classes. Lisa enjoys cooking and focuses on nutritious, balanced meals. She has a robust social life with former colleagues and family and hosts a monthly book club. Lisa values spiritual well-being and attends church regularly, finding peace in prayer and community connection.\",\n    \"calorie_slider\": \"At Target\",\n    \"protein_slider\": \"At Target\",\n    \"fat_slider\": \"At Target\",\n    \"carb_slider\": \"At Target\",\n    \"fasting_slider\": \"None\",\n    \"other_nutr_slider\": \"At Target\",\n    \"sleep_quan_slider\": \"7,8\",\n    \"sleep_qual_slider\": \"Good\",\n    \"sleep_eat_slider\": 2,\n    \"screentime_slider\": 1,\n    \"melatonin_slider\": 0,\n    \"swim_slider\": \"None\",\n    \"run_slider\": \"None\",\n    \"walk_slider\": \"Intense\",\n    \"hike_slider\": \"None\",\n    \"bike_slider\": \"None\",\n    \"team_slider\": \"None\",\n    \"lifting_slider\": \"None\",\n    \"other_exerc_slider\": \"Light\",\n    \"friends_slider\": 20,\n    \"strangers_slider\": 15,\n    \"vol_slider\": 25,\n    \"read_slider\": 20,\n    \"journal_slider\": 0,\n    \"mental_slider\": 15,\n    \"wellbeing_slider\": 15,\n    \"meditate_slider\": 0,\n    \"mindful_slider\": 3,\n    \"religious_slider\": 10,\n    \"pray_slider\": 10,\n    \"yoga_slider\": 5,\n    \"sacred_slider\": 8,\n    \"spirit_slider\": 8\n  }\n]\n","type":"text"},{"name":"Data/individual_weights.json","content":"[\n  {\n    \"name\": \"Sarah üë©üèª‚Äçüíº\",\n    \"Nutrition\": 1.2,\n    \"Sleep\": 1.11,\n    \"Exercise\": 1.15,\n    \"Spirituality\": 1.1,\n    \"Socialization\": 1.25,\n    \"Wellbeing\": 1.5\n  },\n  {\n    \"name\": \"Monique üë©üèæ‚Äçüè´\",\n    \"Nutrition\": 1.01,\n    \"Sleep\": 1.25,\n    \"Exercise\": 1.2,\n    \"Spirituality\": 1,\n    \"Socialization\": 1.5,\n    \"Wellbeing\": 1.25\n  },\n  {\n    \"name\": \"Jenny üë©üèº‚Äçüé®\",\n    \"Nutrition\": 1.5,\n    \"Sleep\": 0.8,\n    \"Exercise\": 1.25,\n    \"Spirituality\": 1,\n    \"Socialization\": 0.9,\n    \"Wellbeing\": 1.3\n  },\n  {\n    \"name\": \"Lori üë©üèΩ‚Äç‚öïÔ∏è\",\n    \"Nutrition\": 1,\n    \"Sleep\": 0.7,\n    \"Exercise\": 1.15,\n    \"Spirituality\": 1.3,\n    \"Socialization\": 1.4,\n    \"Wellbeing\": 1.25\n  },\n\n  {\n    \"name\": \"Kelly üë©üèº‚Äçüíº\",\n    \"Nutrition\": 1,\n    \"Sleep\": 1,\n    \"Exercise\": 1,\n    \"Spirituality\": 1.5,\n    \"Socialization\": 1.3,\n    \"Wellbeing\": 1.2\n  },\n  {\n    \"name\": \"Amy üë©üèª‚Äçüè´\",\n    \"Nutrition\": 1.4,\n    \"Sleep\": 0.8,\n    \"Exercise\": 1.5,\n    \"Spirituality\": 1,\n    \"Socialization\": 1.25,\n    \"Wellbeing\": 1.2\n  },\n\n  {\n    \"name\": \"Melissa üë©üèæ‚Äçüíª\",\n    \"Nutrition\": 1,\n    \"Sleep\": 1.4,\n    \"Exercise\": 1.6,\n    \"Spirituality\": 1.25,\n    \"Socialization\": 1.4,\n    \"Wellbeing\": 1.4\n  },\n  {\n    \"name\": \"Lisa üë©üèº‚Äçüè´\",\n    \"Nutrition\": 1.3,\n    \"Sleep\": 1,\n    \"Exercise\": 1.5,\n    \"Spirituality\": 1.6,\n    \"Socialization\": 1.4,\n    \"Wellbeing\": 1.5\n  }\n]\n","type":"text"},{"name":"R/helper_formatting.R","content":"library(stringr)\n\nindividuals <- readRDS(\"Data/ind_data.rds\")\nweights <- readRDS(\"Data/ind_weights.rds\")\n\n#Just modify this to change factors for everything :)\nfactor_labels <- list(\n  \"Sleep\" = list(\"Insufficient\", \"Sufficient\"),\n  \"Exercise\" = list(\"Light\", \"Intense\"),\n  \"Nutrition\" = list(\"Mindless\", \"Purposeful\"),\n  \"Spirituality\" = list(\"Infrequent\", \"Regular\"),\n  \"Socialization\" = list(\"Isolated\", \"Outgoing\"),\n  \"Wellbeing\" = list(\"Neglect\", \"Nurture\")\n)\nfactor_names <- names(factor_labels)\n\n#Change these to Change Interaction Plot Specific Factors\n  factors_plot_labels <- list(\n    \"Sleep\" = \"Sleep Hours\",\n    \"Exercise\" = \"Exercise\",\n    \"Nutrition\" = \"Nutrition\",\n    \"Spirituality\" = \"Spiritual Engagement\",\n    \"Socialization\" = \"Social Connection\",\n    \"Wellbeing\" = \"Wellbeing\"\n  )\n  \n  lookupFactors <- function(){\n    # Dynamic factors_lookup\n    factors_lookup <- list()\n    \n    # Generate all possible two-factor combinations\n    for (i in seq_along(factor_names)) {\n      for (j in seq(i + 1, length(factor_names))) {\n        factor1 <- factor_names[i]\n        factor2 <- factor_names[j]\n        \n        # Create sorted combination key\n        combo_key <- paste(sort(c(factor1, factor2)), collapse = \"_\")\n        \n        # Define low_low and high_high\n        factors_lookup[[combo_key]] <- list(\n          low_low = c(factor_labels[[factor1]][[1]], factor_labels[[factor2]][[1]]),\n          high_high = c(factor_labels[[factor1]][[2]], factor_labels[[factor2]][[2]])\n        )\n      }\n    }\n    return(factors_lookup)\n    \n  }\n  \n\n#Check if the user is mobile :)\nmobileDetect <- function(inputId, value = 0) {\n  tagList(\n    singleton(tags$head(tags$script(src = \"js/mobile.js\"))),\n    tags$input(id = inputId,\n               class = \"mobile-element\",\n               type = \"hidden\")\n  )\n}\n\nlabelFactors <- function(selected_factors, label_type) {\n  num_factors <- length(selected_factors)\n  # Extract labels for the first num_factors elements in user_input\n  labels <- lapply(selected_factors[1:num_factors], function(factor) {\n    if (factor %in% names(label_type)) {\n      return(label_type[[factor]])\n    } \n  })\n  return(labels)\n}\n\nlabelTableFactors <- function(df, selected_factors) {\n  # Get all possible combinations of factors\n  all_combinations <- list()\n  \n  # Generate all possible combinations of the selected factors\n  for (i in 1:length(selected_factors)) {\n    # Get all combinations of length i\n    combinations <- combn(selected_factors, i, simplify = FALSE)\n    \n    # Add each combination to the list\n    all_combinations <- c(all_combinations, combinations)\n  }\n  \n  # Create row names by joining the factors in each combination with \":\"\n  row_names <- sapply(all_combinations, function(combo) {\n    paste(combo, collapse = \":\")\n  })\n  \n  # Check if the number of combinations matches the expected rows\n  numCombinations <- (2^length(selected_factors)) - 1\n  if (length(row_names) != numCombinations) {\n    warning(\"Number of generated row names does not match expected number of combinations\")\n  }\n  \n  # Assign row names to the dataframe\n  if (nrow(df) >= numCombinations) {\n    row.names(df)[1:numCombinations] <- row_names\n  } else {\n    warning(\"Dataframe has fewer rows than the number of factor combinations\")\n    row.names(df)[1:nrow(df)] <- row_names[1:nrow(df)]\n  }\n  \n  return(df)\n}\n\n#Assign the Selected Factors to the Effect Plot to make it User-Friendly\nformatSigEffect <- function(labels, selected_factors){\n# Abbreviate Nutrition as Nutr, Exercise as Ex, and Sleep is Sleep\n  labels <- gsub(\"A1\", substr(selected_factors[1], 1, 2), labels)\n  labels <- gsub(\"B1\", substr(selected_factors[2], 1, 2), labels)\n  labels <- gsub(\"C1\", substr(selected_factors[3], 1, 2), labels)\n  labels <- gsub(\"D1\", substr(selected_factors[4], 1, 2), labels)\n  labels <- gsub(\"E1\", substr(selected_factors[5], 1, 2), labels)\n  labels <- gsub(\"F1\", substr(selected_factors[6], 1, 2), labels)\n  return(labels)\n}\n\ndisplayTable <- function(f, selected_factors, tableType){\n  \n  isAnova <- tableType == \"anova\"\n  \n  data <- if (isAnova) as.data.frame(anova(f$result)) else as.data.frame(f$design)\n  \n  if (isAnova){\n    anova_results <- anova(f$result)\n    # Round numeric columns to 3 decimal places\n    numeric_cols <- sapply(data, is.numeric)\n    data[, numeric_cols] <- round(data[, numeric_cols], 3)\n    \n    # Format p-values with significance stars\n    if (\"Pr(>F)\" %in% colnames(data)) {\n      # Create a new column for p-value display\n      data$Significance <- \"\"\n      \n      # Add significance stars\n      data$Significance[data$`Pr(>F)` < 0.001] <- \"***\"\n      data$Significance[data$`Pr(>F)` >= 0.001 &\n                          data$`Pr(>F)` < 0.01] <- \"**\"\n      data$Significance[data$`Pr(>F)` >= 0.01 &\n                          data$`Pr(>F)` < 0.05] <- \"*\"\n      data$Significance[data$`Pr(>F)` >= 0.05 &\n                          data$`Pr(>F)` < 0.1] <- \".\"\n      \n      # Format p-values for better readability\n      data$`Pr(>F)` <- sprintf(\"%.3f %s\", data$`Pr(>F)`, data$Significance)\n      \n      # Remove the separate significance column\n      data$Significance <- NULL\n    }\n    data <- labelTableFactors(data, selected_factors)\n    \n  }\n  \n  table <- kable(data, row.names = TRUE) %>%\n    kable_styling(\n      bootstrap_options = c(\"striped\", \"responsive\"),\n      full_width = FALSE, position = if (isAnova) \"left\" else \"center\"\n    )\n  \n  if (isAnova){\n    table <- table %>% row_spec(\n      which(anova_results[, \"Pr(>F)\"] < 0.05),\n      bold = TRUE,\n      background = \"#e67763\",\n      color = \"#FFF\"\n    ) %>%\n      # Add footer with significance key\n      add_footnote(\n        c(\"Significance codes: *** p<0.001, ** p<0.01, * p<0.05, . p<0.1\"),\n        notation = \"none\"\n      )\n    \n  } else {\n    # Check if each factor exists and apply appropriate styling\n    for (i in seq_along(selected_factors)) {\n      factor_name <- selected_factors[i]\n      col_index <- i + 1  # +1 because column 1 is row names\n      \n      # Only apply spec_color if the column exists and contains numeric or factor data\n      if (factor_name %in% colnames(data)) {\n        # Check if column is numeric or can be converted to numeric\n        col_data <- data[[factor_name]]\n        \n        # For factors, convert to numeric 1/2 for Low/High\n        if (is.numeric(col_data)) {\n          # If it's already numeric, use it directly\n          table <- table %>%\n            column_spec(\n              col_index,\n              color = 'white',\n              background = spec_color(col_data, end = 0.7, option = 'A')\n            )\n        }\n      }\n    }\n  }\n  return(HTML(table))\n}","type":"text"},{"name":"R/slider_logic.R","content":"slider_mappings <- list(\n  \"Nutrition\" = list(\"calorie_slider\",\"protein_slider\",\n                \"fat_slider\", \"carb_slider\", \"fasting_slider\",\n                \"other_nutr_slider\"),\n  \n  \"Sleep\" = list(\"sleep_quan_slider\", \"sleep_qual_slider\", \n                 \"sleep_eat_slider\", \"screentime_slider\", \"melatonin_slider\"),\n  \n  \"Exercise\" = list(\"swim_slider\", \"run_slider\", \"walk_slider\", \n                    \"hike_slider\",\"bike_slider\", \"team_slider\",\n                    \"lifting_slider\", \"other_exerc_slider\"),\n  \n  \"Socialization\" = list(\"friends_slider\", \"strangers_slider\", \"vol_slider\"),\n  \n  \"Wellbeing\" = list(\"read_slider\", \"journal_slider\",\n                     \"mental_slider\", \"wellbeing_slider\"),\n  \n  \"Spirituality\" = list(\"meditate_slider\", \"mindful_slider\", \n                        \"religious_slider\", \"pray_slider\", \"yoga_slider\",\n                        \"sacred_slider\", \"spirit_slider\")\n)\n\n\n\n","type":"text"},{"name":"R/ui_cards.R","content":"library(bslib)\nlibrary(bsicons)\nlibrary(plotly)\nlibrary(echarts4r)\n\n# Global Variables, adjust if needed:\nmin_plot_height <- 625\nmin_table_height <- 10\n\nintro_card <- card(\n  h5(\"Healthy Habits Circle Simulated Experiment Design\", style = \"font-weight: bold;\"), # nolint\n  p(\"2¬≥ factorial design with the following factors:\"),\n  # nolint\n  tags$div(\n    style = \"margin-left: 15px;\",\n    HTML(\"<b>Nutrition:<\/b>\"),\n    tags$ul(\n      tags$li(HTML(\"Purposeful: Tracking calories or practicing healthy eating habits\")),\n      tags$li(\"Mindless: Not planning or practicing healthy eating habits\")\n    ),\n    HTML(\"<b>Sleep:<\/b>\"),\n    tags$ul(\n      tags$li(\"Sufficient: 7 hours of sleep\"),\n      tags$li(\"Insufficient: ‚â§ 7 hours of sleep\")\n    ),\n    HTML(\"<b>Exercise:<\/b> <i>Exercise Intensity<\/i>\"),\n    tags$ul(\n      tags$li(\"Intense: Engaging in more-strenuous activities\"),\n      tags$li(\"Light: Engaging in non-strenuous actvities or no exercise\")\n    )\n  ),\n  p(HTML(\"<b>Response:<\/b> <i>Health Score<\/i>\"))\n)\n\nplot_card <- list(\n  card(\n    card_header(\"Interaction Plot\"),\n    min_height = min_plot_height,\n    full_screen = TRUE,\n    card_body(\n      layout_columns(\n        value_box(\n          title = \"Standard Deviation\",\n          value = textOutput(\"sd\"),\n          showcase = bs_icon(\"badge-sd-fill\"),\n        ),\n        value_box(\n          title = \"Change in Health\",\n          value = textOutput(\"health_change\"),\n          showcase = bs_icon(\"heart-pulse-fill\"),\n        )\n      ),\n      echarts4rOutput(\"interaction_plot\")\n    )\n  ),\n  card(\n    card_header(\"Factorial Design Plot through Plotly\"),\n    full_screen = TRUE,\n    min_height = min_plot_height,\n    plotlyOutput(\"factorial\")\n    \n  ),\n  card(\n    card_header(\"Effects\"),\n    full_screen = TRUE,\n    min_height = min_plot_height,\n    plotOutput(\"effects_plot\")\n  ),\n  card(\n    card_header(\"Residual vs Fitted Graph\"),\n    full_screen = TRUE,\n    min_height = min_plot_height,\n    plotOutput(\"residual\")\n  ),\n  card(\n    card_header(\"Normal QQ Plot\"),\n    full_screen = TRUE,\n    min_height = min_plot_height,\n    plotOutput(\"QQ\")\n  )\n)\n\ntable_card <- list(\n  card(\n    card_header(\"ANOVA Table\"),\n    min_height = min_table_height,\n    uiOutput(\"anova\")\n  ),\n  card(\n    card_header(\"Factorial Design Table\"),\n    min_height = min_table_height,\n    uiOutput(\"design\")\n  ),\n  card(\n    card_header(\"Effects Table\"),\n    min_height = min_table_height,\n    uiOutput(\"effects_output\")\n  )\n)\n\ntext_card <- list(\n  card(\n    verbatimTextOutput(\"independence\")\n  ),\n  card(\n    verbatimTextOutput(\"outlier\")\n  )\n)\n","type":"text"},{"name":"Rplots.pdf","content":"%PDF-1.4\n%Å‚Å„ÅœÅ”\\r\n1 0 obj\n<<\n/CreationDate (D:20250415163229)\n/ModDate (D:20250415163229)\n/Title (R Graphics Output)\n/Producer (R 4.4.2)\n/Creator (R)\n>>\nendobj\n2 0 obj\n<< /Type /Catalog /Pages 3 0 R >>\nendobj\n7 0 obj\n<< /Type /Page /Parent 3 0 R /Contents 8 0 R /Resources 4 0 R >>\nendobj\n8 0 obj\n<<\n/Length 169 /Filter /FlateDecode\n>>\nstream\nxúMå=\u000fÇ0\u0018\u0006˜˛ä«\rñ⁄ñ\u0012`%Ò#L`ö8\u0018áZ_Ç¶¢P\u0018¸˜ö‡‡r…Âíì® q«¿\u001a\fH\u000b.4≤Ñk\r-5œ\u0014íLÚTa$\u001c—≥“∞u8ÏJ∏¿\u0004\u0017B‡ü¡ılΩUﬂ°i!s˛\u000b\u000b\u0016W\u0005œ\u0013®TÛ4Éy‡\u0014’ûl \u0004Ú‰&(Ñ˘“∆H\u0004\"Î¶Á\u00180˜W\u001a1uÑ∫[¬;‹úıÿìıSáóÌ…Ø‚3L≈6Ü5Ï\u0003\u0011]4«endstream\nendobj\n9 0 obj\n<< /Type /Page /Parent 3 0 R /Contents 10 0 R /Resources 4 0 R >>\nendobj\n10 0 obj\n<<\n/Length 169 /Filter /FlateDecode\n>>\nstream\nxúMå=\u000fÇ0\u0018\u0006˜˛ä«\rñ⁄ñ\u0012`%Ò#L`ö8\u0018áZ_Ç¶¢P\u0018¸˜ö‡‡r…Âíì® q«¿\u001a\fH\u000b.4≤Ñk\r-5œ\u0014íLÚTa$\u001c—≥“∞u8ÏJ∏¿\u0004\u0017B‡ü¡ılΩUﬂ°i!s˛\u000b\u000b\u0016W\u0005œ\u0013®TÛ4Éy‡\u0014’ûl \u0004Ú‰&(Ñ˘“∆H\u0004\"Î¶Á\u00180˜W\u001a1uÑ∫[¬;‹úıÿìıSáóÌ…Ø‚3L≈6Ü5Ï\u0003\u0011]4«endstream\nendobj\n11 0 obj\n<< /Type /Page /Parent 3 0 R /Contents 12 0 R /Resources 4 0 R >>\nendobj\n12 0 obj\n<<\n/Length 169 /Filter /FlateDecode\n>>\nstream\nxúMå=\u000fÇ0\u0018\u0006˜˛ä«\rñ⁄ñ\u0012`%Ò#L`ö8\u0018áZ_Ç¶¢P\u0018¸˜ö‡‡r…Âíì® q«¿\u001a\fH\u000b.4≤Ñk\r-5œ\u0014íLÚTa$\u001c—≥“∞u8ÏJ∏¿\u0004\u0017B‡ü¡ılΩUﬂ°i!s˛\u000b\u000b\u0016W\u0005œ\u0013®TÛ4Éy‡\u0014’ûl \u0004Ú‰&(Ñ˘“∆H\u0004\"Î¶Á\u00180˜W\u001a1uÑ∫[¬;‹úıÿìıSáóÌ…Ø‚3L≈6Ü5Ï\u0003\u0011]4«endstream\nendobj\n13 0 obj\n<< /Type /Page /Parent 3 0 R /Contents 14 0 R /Resources 4 0 R >>\nendobj\n","type":"text"},{"name":"design.R","content":"library(shiny)\nlibrary(bslib)\nlibrary(daewr)\nlibrary(DoE.base)\nlibrary(ggplot2)\nlibrary(car)\nlibrary(DT)\n\n# Define UI\nui <- fluidPage(\n  titlePanel(\"2^3 Factorial Design Demonstration\"),\n  theme = bs_theme(\n    bootswatch = \"journal\"\n  ),\n  sidebarLayout(\n    sidebarPanel(\n      selectInput(\"dataset\", \"Select Dataset:\",\n                  choices = c(\"Voltmeter Experiment\", \"Custom Data\")),\n      conditionalPanel(\n        condition = \"input.dataset == 'Custom Data'\",\n        fileInput(\"datafile\", \"Upload your CSV file\",\n                  accept = c(\"text/csv\", \"text/comma-separated-values,text/plain\", \".csv\"))\n      ),\n      selectInput(\"tab\", \"Select View:\",\n                  choices = c(\"Design\", \"Assumptions\", \"ANOVA\", \"Effects\", \"Interactions\")),\n      conditionalPanel(\n        condition = \"input.tab == 'Interactions'\",\n        selectInput(\"interaction\", \"Select Interaction:\",\n                    choices = c(\"A√óB\", \"A√óC\", \"B√óC\"))\n      ),\n      br(),\n      h4(\"Voltmeter Experiment Design\", style = \"font-weight: bold;\"),\n      p(\"2¬≥ factorial design with the following factors:\"),\n      \n      tags$div(\n        style = \"margin-left: 15px;\",\n        HTML(\"<b>Factor A:<\/b> Ambient Temperature\"),\n        tags$ul(\n          tags$li(\"Low: 22¬∞C\"),\n          tags$li(\"High: 32¬∞C\")\n        ),\n        \n        HTML(\"<b>Factor B:<\/b> Voltmeter Warm-up Time\"),\n        tags$ul(\n          tags$li(\"Low: 0.5 min\"),\n          tags$li(\"High: 5 min\")\n        ),\n        \n        HTML(\"<b>Factor C:<\/b> Circuit Warm-up Time\"),\n        tags$ul(\n          tags$li(\"Low: 0.5 min\"),\n          tags$li(\"High: 5 min\")\n        )\n      ),\n      \n      p(HTML(\"<b>Response:<\/b> Measured voltage in millivolts\")),\n      p(\"The design has 2 replicates for each treatment combination.\"),\n    ),\n    \n    mainPanel(\n      conditionalPanel(\n        condition = \"input.tab == 'Design'\",\n        h3(\"Experimental Design\"),\n        DTOutput(\"design_table\"),\n      ),\n      conditionalPanel(\n        condition = \"input.tab == 'ANOVA'\",\n        h3(\"ANOVA Results\"),\n        verbatimTextOutput(\"anova_output\")\n      ),\n      conditionalPanel(\n        condition = \"input.tab == 'Effects'\",\n        h3(\"Effects Analysis\"),\n        plotOutput(\"effects_plot\"),\n        verbatimTextOutput(\"effects_output\")\n      ),\n      conditionalPanel(\n        condition = \"input.tab == 'Interactions'\",\n        h3(\"Interaction Plots\"),\n        plotOutput(\"interaction_plot\")\n      ),\n      conditionalPanel(\n        condition = \"input.tab == 'Assumptions'\",\n        h3(\"Model Assumptions\"),\n        tabsetPanel(\n          tabPanel(\"Residuals vs Fitted\", plotOutput(\"resid_fitted\")),\n          tabPanel(\"Normal Q-Q\", plotOutput(\"qq_plot\")),\n          tabPanel(\"Outlier Check\", verbatimTextOutput(\"outlier_check\"))\n        )\n      )\n    )\n  )\n)\n\n# Define server logic\nserver <- function(input, output, session) {\n  \n  # Data reactive\n  getData <- reactive({\n    if (input$dataset == \"Voltmeter Experiment\") {\n      # Load the voltmeter experiment data from daewr package\n      data(volt)\n      return(volt)\n    } else if (input$dataset == \"Custom Data\" && !is.null(input$datafile)) {\n      # Load custom data\n      read.csv(input$datafile$datapath)\n    } else {\n      # Default to volt data if no file uploaded\n      data(volt)\n      return(volt)\n    }\n  })\n  \n  # Fit model reactive\n  getModel <- reactive({\n    df <- getData()\n    # Create model using contr.FrF2 for proper coding\n    model <- lm(y ~ A*B*C, data = df, \n                contrasts = list(A = contr.FrF2, B = contr.FrF2, C = contr.FrF2))\n    return(model)\n  })\n  \n  # Output: Experimental Design Table\n  output$design_table <- renderDT({\n    df <- getData()\n    datatable(df, options = list(pageLength = 16))\n  })\n  \n  \n  # Output: ANOVA Results\n  output$anova_output <- renderPrint({\n    model <- getModel()\n    \n    # Print summary and ANOVA\n    cat(\"Model Summary:\\n\")\n    print(summary(model))\n    \n    cat(\"\\n\\nANOVA Table:\\n\")\n    print(anova(model))\n    \n    # Add Type II ANOVA\n    cat(\"\\n\\nType II ANOVA:\\n\")\n    print(Anova(model, type = 2))\n    \n    # Add Type III ANOVA\n    drop1(model, .~., test=\"F\")\n    cat(\"\\n\\nType III ANOVA:\\n\")\n    print(Anova(model, type = 3))\n  })\n  \n  # Output: Effects Analysis\n  output$effects_plot <- renderPlot({\n    model <- getModel()\n    \n    # Extract coefficients (half effects)\n    coeffs <- coef(model)[-1]  # Remove intercept\n    \n    # Create half-normal plot of effects\n    par(mfrow = c(1, 2))\n    \n    # Normal plot\n    qqnorm(coeffs, main = \"Normal Plot of Effects\", \n           xlab = \"Normal Scores\", ylab = \"Estimated Effects\", \n           pch = 16, col = \"blue\")\n    abline(lm(sort(coeffs) ~ qnorm(ppoints(length(coeffs)))))\n    \n    # Half-normal plot\n    abs_coeffs <- abs(coeffs)\n    qqnorm(abs_coeffs, main = \"Half-Normal Plot of Effects\", \n           xlab = \"Half-Normal Scores\", ylab = \"Absolute Effects\", \n           pch = 16, col = \"red\", plot.it = FALSE)\n    plot_data <- qqnorm(abs_coeffs, plot.it = FALSE)\n    plot(plot_data$x, plot_data$y, main = \"Half-Normal Plot of Effects\", \n         xlab = \"Half-Normal Scores\", ylab = \"Absolute Effects\", \n         pch = 16, col = \"red\")\n    \n    # Add labels for significant effects\n    parnames <- names(coeffs)\n    labeled <- abs_coeffs > (2 * sd(abs_coeffs))\n    if (any(labeled)) {\n      text(plot_data$x[labeled], plot_data$y[labeled], \n           labels = parnames[labeled], pos = 2)\n    }\n  })\n  \n  # Output: Effects Analysis Text\n  output$effects_output <- renderPrint({\n    model <- getModel()\n    \n    # Extract coefficients (half effects)\n    coeffs <- coef(model)[-1]  # Remove intercept\n    \n    # Calculate full effects (2 √ó coefficients)\n    effects <- 2 * coeffs\n    \n    # Create a data frame of effects\n    effects_df <- data.frame(\n      Effect = names(effects),\n      Estimate = effects,\n      `Half_Effect` = coeffs,\n      `Std_Error` = summary(model)$coefficients[-1, \"Std. Error\"],\n      `t_value` = summary(model)$coefficients[-1, \"t value\"],\n      `Pr(>|t|)` = summary(model)$coefficients[-1, \"Pr(>|t|)\"]\n    )\n    \n    # Print effects table\n    cat(\"Effects Table:\\n\")\n    print(effects_df)\n    \n    # Identify significant effects\n    cat(\"\\nSignificant Effects (p < 0.05):\\n\")\n    sig_effects <- effects_df[effects_df$`Pr(>|t|)` < 0.05, ]\n    if (nrow(sig_effects) > 0) {\n      print(sig_effects)\n    } else {\n      cat(\"No significant effects found at alpha = 0.05\\n\")\n    }\n  })\n  \n  # Output: Interaction Plot\n  output$interaction_plot <- renderPlot({\n    df <- getData()\n    \n    if (input$interaction == \"A√óB\") {\n      interaction.plot(df$A, df$B, df$y, type = \"b\", \n                       xlab = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Ambient Temperature (ÀöC)\" else \"Factor A\", \n                       ylab = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Voltage (mV)\" else \"Response\",\n                       trace.label = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Warm-up minutes\" else \"Factor B\", \n                       main = if (input$dataset == \"Voltmeter Experiment\") \n                             \"Interaction Plot of Temperature x Voltmeter Warm-up Time\" \n                              else \"Interaction Plot of A √ó B\",\n                       pch = c(19, 17), lty = c(1, 2), \n                       col = c(\"blue\", \"red\"), lwd = 2)\n    } else if (input$interaction == \"A√óC\") {\n      interaction.plot(df$A, df$C, df$y, type = \"b\", \n                       xlab = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Ambient Temperature (ÀöC)\" else \"Factor A\",  \n                       ylab = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Voltage (mV)\" else \"Response\",\n                       trace.label = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Warm-up minutes\" else \"Factor C\", \n                       main = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Interaction Plot of Temperature x Circuit Warm-up Time\" \n                       else \"Interaction Plot of A √ó C\",\n                       pch = c(19, 17), lty = c(1, 2), \n                       col = c(\"blue\", \"red\"), lwd = 2)\n    } else if (input$interaction == \"B√óC\") {\n      interaction.plot(df$B, df$C, df$y, type = \"b\", \n                       xlab = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Voltmeter Warm-up\" else \"Factor B\", \n                       ylab = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Voltage (mV)\" else \"Response\",\n                       trace.label = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Circuit Warm-up\" else \"Factor C\",  \n                       main = if (input$dataset == \"Voltmeter Experiment\") \n                         \"Interaction Plot of Voltmeter Warm-up Time x Circuit Warm-up Time\" \n                       else \"Interaction Plot of B √ó C\",\n                       pch = c(19, 17), lty = c(1, 2), \n                       col = c(\"blue\", \"red\"), lwd = 2)\n    }\n  })\n  \n  # Output: Model Assumption Checks\n  \n  # Residuals vs Fitted\n  output$resid_fitted <- renderPlot({\n    model <- getModel()\n    plot(fitted(model), residuals(model), \n         xlab = \"Fitted Values\", ylab = \"Residuals\",\n         main = \"Residuals vs Fitted\", pch = 19, col = \"blue\")\n    abline(h = 0, lty = 2, col = \"red\")\n  })\n  \n  # Normal Q-Q Plot\n  output$qq_plot <- renderPlot({\n    model <- getModel()\n    qqnorm(residuals(model), main = \"Normal Q-Q Plot\", pch = 19, col = \"blue\")\n    qqline(residuals(model), col = \"red\", lwd = 2)\n  })\n  # Outlier Check\n  output$outlier_check <- renderPrint({\n    model <- getModel()\n    df <- getData()\n    \n    # Try to use Gaptest from daewr if data structure is appropriate\n    tryCatch({\n      if (input$dataset == \"Voltmeter Experiment\") {\n        cat(\"Gaptest Analysis for Outlier Detection:\\n\")\n        gap_result <- Gaptest(df)\n        \n        if (is.null(gap_result)){\n          cat(\"There are no outliers in this dataset!\")\n        } else {\n          print(gap_result)\n        }\n      } else {\n        cat(\"Outlier check only available for built-in datasets with appropriate structure.\\n\")\n      }\n    }, error = function(e) {\n      cat(\"Error in outlier detection: \", e$message, \"\\n\")\n      cat(\"Cook's Distances for potential outliers:\\n\")\n      cooks_d <- cooks.distance(model)\n      print(sort(cooks_d[cooks_d > 4/length(cooks_d)], decreasing = TRUE))\n    })\n  })\n}\n\n# Run the application \nshinyApp(ui = ui, server = server)","type":"text"},{"name":"shinyapp.Rproj","content":"Version: 1.0\nProjectId: 6da9dab7-061e-454a-bafa-2df622aeab41\n\nRestoreWorkspace: Default\nSaveWorkspace: Default\nAlwaysSaveHistory: Default\n\nEnableCodeIndexing: Yes\nUseSpacesForTab: Yes\nNumSpacesForTab: 2\nEncoding: UTF-8\n\nRnwWeave: Sweave\nLaTeX: pdfLaTeX\n\nProjectName: shiny\n","type":"text"},{"name":"www/styles.css","content":"#factors .btn-group {\n  flex-wrap: wrap;\n  max-width: 280px; \n}\n\n#phys .btn-group {\n  flex-wrap: wrap;\n  max-width: 280px; \n}\n\n","type":"text"}]
